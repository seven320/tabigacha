<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8">
    <!-- css link -->
    <link rel="stylesheet" href="css/stylesheet.css">
    <title>Tabi gacha</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="./jmap.js"></script>
    <script type = "text/javascript">
        var prefecture_id = 0
        function loadmap(){
            $(document).ready(function() {
            $('#jmap').jmap({
                width: "600px",
                height: "450px",
                prefectureBackgroundColor: 'gray',  
            areas: [
                {code: prefecture_id, color: "black"
            }
            ]
            });
        });
        }

        loadmap();
    </script>
</head>
<body>
    <div id="jmap" class= "map"></div>

    <button type="button" id = "gacha">ガチャする</button>
</body>

    <script>
        var intervalID
        function getRandomint(max){
            return Math.floor(Math.random() * max)
        }

        function showrandomloadmap(){
            prefecture_id = getRandomint(47)+1
            console.log(prefecture_id)
            loadmap()
        }

        function buttonClick(){
            let time = 0;
            // ガチャ開始でランダムに表示する
            let time_delta = 100
            for(var i=0; i<15; i++){
                time += 100
                setTimeout(showrandomloadmap, time);
            }
            // ガチャの最後の部分で速度を落としていく
            for(var j=0; j < 10; j++){
                time_delta += 50
                time += time_delta
                setTimeout(showrandomloadmap, time);
            }
        }

        
        var button = document.getElementById("gacha")
        button.onclick = buttonClick;
    </script>
</html>